# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [2.0.3] - 2025-01-27

### Added
- **完整的源碼審核和文檔更新**
  - 全面審核原始碼品質和安全性
  - 更新所有相關文檔和說明
  - 改進錯誤處理機制
  - 開發環境專用規則和配置
  - 完整的測試覆蓋
  - **Redmine 6.0.6 完整支援和測試驗證**

### Changed
- **版本相容性更新**
  - **主要支援 Redmine 6.0.6** - 完整測試和驗證
  - 更新所有文檔以明確支援 6.0.6 版本
  - 提升版本號至 2.0.3
  - 統一版本支援說明

- **路由配置優化**
  - 修正 `review_controller.rb` 中的路由定義與實際控制器名稱不匹配問題
  - 更新 `config/routes.rb` 中的控制器指定
  - 修正效能監控路由配置，使用明確的路由匹配

- **權限檢查邏輯改進**
  - 修正 `review_controller.rb` 中的權限檢查邏輯
  - 添加 `find_project` 方法和錯誤處理
  - 改進批次操作的錯誤處理
  - 統一權限檢查的實作方式

- **錯誤處理增強**
  - 在所有關鍵方法中添加 `begin/rescue` 錯誤處理
  - 改進 `sensitive_data_guard_hooks.rb` 中的錯誤處理
  - 修正 `cache_manager.rb` 中的快取錯誤處理
  - 統一錯誤日誌記錄格式

- **程式碼重構**
  - 重構 `sensitive_data_guard_hooks.rb` 中的重複程式碼
  - 統一錯誤處理和日誌記錄方式
  - 移除無效和重複的程式碼

- **本地化翻譯更新**
  - 添加缺失的本地化翻譯項目
  - 修正翻譯鍵的名稱和格式
  - 更新中文繁體翻譯內容

- **模型方法改進**
  - 改進 `SensitiveOperationLog` 模型中的方法
  - 添加 `review_statistics` 方法
  - 修正 `detected_patterns_parsed` 方法的錯誤處理
  - 優化資料庫查詢效能

- **測試覆蓋更新**
  - 更新 `test_helper.rb` 中的測試輔助方法
  - 修正測試資料創建方法
  - 改進測試的穩定性和可靠性

### Fixed
- **路由問題修正**
  - 修正控制器名稱與路由不匹配問題
  - 解決效能監控頁面路由錯誤
  - 統一路由命名規範

- **權限檢查修正**
  - 修正審核功能的權限檢查邏輯
  - 改進批次操作的權限驗證
  - 統一權限檢查的實作

- **錯誤處理修正**
  - 修正檔案掃描的錯誤處理
  - 改進快取機制的穩定性
  - 統一錯誤訊息格式

- **程式碼品質修正**
  - 移除重複和無效的程式碼
  - 統一程式碼風格和命名規範
  - 改進方法的可讀性和維護性

- **本地化修正**
  - 修正翻譯鍵的引用問題
  - 統一翻譯內容的格式
  - 添加缺失的翻譯項目

### Removed
- **移除無效項目**
  - 移除未使用的程式碼註釋
  - 清理過時的測試方法
  - 移除重複的錯誤處理程式碼
  - 移除不必要的快取方法

### Security
- **安全性增強**
  - 改進權限檢查邏輯
  - 加強敏感資料處理的安全性
  - 統一安全相關的實作

## [2.0.2] - 2025-01-27

### Added
- **完整的檔案掃描功能**
  - 支援多種檔案類型掃描（TXT, CSV, DOC, XLS, PDF 等）
  - 檔案大小限制和類型檢查
  - 附件上傳攔截機制
- **美化的使用者介面**
  - 附件掃描警告顯示
  - 檔案掃描相關 CSS 樣式
  - 完整的本地化翻譯
- **詳細的風險等級設定**
  - 四個風險等級的獨立設定區塊
  - 每個風險等級的個別項目設定
  - 處理策略的獨立設定

### Changed
- 文檔整理和更新
- 實作計劃更新
- 反映當前實際進度

### Fixed
- **Frozen String 錯誤修復**
  - 解決 Ruby 3.0+ 字串凍結問題
  - 修復 `sensitive_data_guard_hooks.rb` 中的字串操作

## [2.0.0] - 2025-01-27

### Added
- **Redmine 6.0.6 版本支援**
- **Rails 7.2.2.1 相容性**
- **Ruby 3.3.9 支援**
- 簡化版敏感資料偵測功能
- 基礎插件架構相容性

### Changed
- **升級 requires_redmine 版本限制至 '6.0.0'**
- **更新 Gemfile 依賴版本以支援 Rails 6+**
- **簡化插件架構以解決 Zeitwerk 自動載入問題**

### Removed
- **移除複雜的敏感資料偵測邏輯**
- **移除通知服務**
- **移除與主 Redmine 衝突的 gem 依賴**

### Fixed
- **解決 Zeitwerk 自動載入錯誤**
- **解決 gem 版本衝突問題**
- **解決 Rails 6 相容性問題**

### Security
- 保持基本的敏感資料記錄功能
- 維持權限控制架構

## [1.0.0] - 2024-12-19

### Added
- 敏感資料偵測功能
- Office 文件掃描支援
- 操作稽核記錄
- 自動日誌清理
- 管理介面
- 權限管理系統

### Security
- 符合個資法與 GDPR 規範
- 安全的日誌處理機制
- 權限控制與驗證

---

## 版本說明

### 版本號格式
- **主版本號**：重大功能更新或架構變更
- **次版本號**：新功能增加
- **修訂版本號**：Bug 修復和效能優化

### 版本相容性
- **v1.0.x**：支援 Redmine 4.1.1
- **v2.0.x**：支援 Redmine 6.0.6 (Rails 7.2.2.1, Ruby 3.3.9)

### 更新重點

#### 2.0.3 版本更新重點
1. **程式碼品質提升**：全面審核和修正程式碼問題
2. **錯誤處理增強**：統一錯誤處理機制和日誌記錄
3. **路由配置修正**：解決路由和控制器不匹配問題
4. **權限檢查改進**：統一權限檢查邏輯和實作
5. **本地化完善**：更新翻譯內容和格式
6. **測試覆蓋更新**：改進測試穩定性和可靠性

---

**維護者：** 開發團隊  
**最後更新：** 2025-01-27 